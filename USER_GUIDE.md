# Jira Template Buttons - Руководство пользователя

## Что это такое?

**Jira Template Buttons** — это расширение для Chrome, которое добавляет кнопки с искусственным интеллектом прямо в интерфейс Jira. Расширение помогает автоматически улучшать описания задач, генерировать контент и работать с шаблонами, используя современные LLM модели (ChatGPT, Gemini и другие).

## Основные возможности

### 🤖 LLM-интеграция
- Поддержка **OpenAI** (ChatGPT), **Google Gemini** и **кастомных API**
- Возможность ввода собственных моделей (например, gpt-4o, gemini-2.0-flash-exp)
- Автоматическое улучшение текста задач одним кликом

### 📝 Few-Shot Prompting
- Добавление собственных шаблонов Jira задач как примеров для ИИ
- ИИ учится на ваших примерах и создает задачи в том же стиле
- Опциональная функция — работает и без шаблонов

### 🔧 Гибкие настройки
- Два типа авторизации для кастомных API (токен или логин/пароль)
- Поддержка различных URL-паттернов Jira (`jira.company.com`, `jira2.company.com` и т.д.)
- Настраиваемые системные промпты

## Архитектура и взаимодействие компонентов

### Диаграмма взаимодействия

```
┌─────────────────┐    ┌──────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Пользователь  │    │ Chrome Extension │    │    LLM API      │    │  Jira Content   │
│                 │    │                  │    │                 │    │                 │
└─────────┬───────┘    └─────────┬────────┘    └─────────┬───────┘    └─────────┬───────┘
          │                      │                       │                      │
          │ 1. Открывает задачу  │                       │                      │
          │    для редактирования │                       │                      │
          ├─────────────────────►│                       │                      │
          │                      │                       │                      │
          │                      │ 2. Внедряет кнопки    │                      │
          │                      │    в DOM Jira         │                      │
          │                      ├──────────────────────────────────────────────►│
          │                      │                       │                      │
          │ 3. Нажимает кнопку   │                       │                      │
          │    "Улучшить"        │                       │                      │
          ├─────────────────────►│                       │                      │
          │                      │                       │                      │
          │                      │ 4. Читает текст из    │                      │
          │                      │    поля описания      │                      │
          │                      │◄──────────────────────────────────────────────┤
          │                      │                       │                      │
          │                      │ 5. Формирует промпт   │                      │
          │                      │    (системный промпт + │                      │
          │                      │     шаблон + текст)   │                      │
          │                      │                       │                      │
          │                      │ 6. Отправляет запрос  │                      │
          │                      │    к LLM API          │                      │
          │                      ├──────────────────────►│                      │
          │                      │                       │                      │
          │                      │                       │ 7. Обрабатывает     │
          │                      │                       │    запрос и          │
          │                      │                       │    генерирует ответ │
          │                      │                       │                      │
          │                      │ 8. Получает улучшенный│                      │
          │                      │    текст от LLM       │                      │
          │                      │◄──────────────────────┤                      │
          │                      │                       │                      │
          │                      │ 9. Заменяет содержимое│                      │
          │                      │    поля описания      │                      │
          │                      ├──────────────────────────────────────────────►│
          │                      │                       │                      │
          │                      │ 10. Сохраняет версию  │                      │
          │                      │     в истории         │                      │
          │                      │                       │                      │
          │ 11. Видит улучшенный │                       │                      │
          │     текст в поле     │                       │                      │
          │◄─────────────────────┼───────────────────────────────────────────────┤
          │                      │                       │                      │
```

### Компоненты системы

#### 1. **Пользователь**
- Открывает задачи Jira для редактирования
- Взаимодействует с кнопками расширения
- Получает улучшенный контент

#### 2. **Chrome Extension**
- **Content Script** (`content.js`):
  - Внедряется в страницы Jira
  - Добавляет кнопки в интерфейс
  - Читает и изменяет содержимое полей
  - Управляет историей версий
- **Background Script** (`background.js`):
  - Обрабатывает API запросы к LLM
  - Управляет авторизацией
  - Формирует промпты
- **Options Page** (`options.html`):
  - Интерфейс настроек
  - Конфигурация LLM провайдеров
  - Управление шаблонами

#### 3. **LLM API**
- **OpenAI API**: ChatGPT модели (gpt-4o, gpt-4-turbo)
- **Google Gemini API**: Gemini модели (gemini-2.0-flash-exp)
- **Кастомные API**: Корпоративные или альтернативные провайдеры

#### 4. **Jira Content**
- DOM элементы страниц Jira
- Поля описания задач
- Формы создания и редактирования

### Поток данных

1. **Инициализация**: Расширение загружается при открытии страниц Jira
2. **Внедрение UI**: Content script добавляет кнопки в поля описания
3. **Пользовательский ввод**: Пользователь вводит текст и нажимает кнопку
4. **Сбор контекста**: Расширение читает текст, системный промпт и шаблон
5. **Формирование запроса**: Background script создает структурированный промпт
6. **API вызов**: Отправка запроса к выбранному LLM провайдеру
7. **Обработка ответа**: Получение и валидация ответа от LLM
8. **Обновление UI**: Замена содержимого поля улучшенным текстом
9. **Сохранение истории**: Версионирование для возможности отката

### Безопасность и приватность

- **Локальное хранение**: API ключи хранятся в Chrome Storage
- **Прямые запросы**: Данные передаются напрямую к LLM провайдеру
- **Без посредников**: Расширение не использует промежуточные серверы
- **Контроль доступа**: Пользователь полностью контролирует свои данные

## Установка

1. Скачайте расширение или соберите из исходного кода
2. Откройте Chrome → Управление расширениями → Режим разработчика
3. Нажмите "Загрузить распакованное расширение" и выберите папку `dist/`
4. Расширение появится в списке установленных

## Настройка

### Шаг 1: Выбор провайдера LLM

Откройте настройки расширения и выберите один из провайдеров:

#### OpenAI (ChatGPT)
- **Модель**: Выберите из списка или введите свою (например, `gpt-4o`, `gpt-4-turbo`)
- **API URL**: Оставьте стандартный или укажите свой
- **API ключ**: Получите на [platform.openai.com](https://platform.openai.com)

#### Google Gemini
- **Модель**: Выберите из списка или введите свою (например, `gemini-2.0-flash-exp`)
- **API URL**: Стандартный Google API или свой
- **API ключ**: Получите в [Google AI Studio](https://aistudio.google.com)

#### Кастомный API
Два варианта авторизации:

**Авторизация по токену:**
- **URL чата**: Прямой endpoint для запросов
- **API токен**: Ваш токен доступа
- Подходит для большинства современных API

**Авторизация по логину/паролю:**
- **URL авторизации**: Endpoint для получения токена
- **URL чата**: Endpoint для запросов
- **Логин/пароль**: Ваши учетные данные
- Подходит для корпоративных API с двухэтапной авторизацией

### Шаг 2: Системный промпт

Настройте базовое поведение ИИ:

```
Ты — помощник для создания и улучшения Jira задач. 
Отвечай кратко и структурированно. 
Используй профессиональный тон.
```

### Шаг 3: Шаблон Jira задачи (опционально)

Это ключевая новая функция! Добавьте пример хорошо оформленной задачи:

```
Заголовок: Исправить баг с авторизацией пользователей

Описание: 
При попытке входа в систему пользователи получают ошибку 500. 
Проблема возникает на странице логина при отправке формы с корректными данными.

Шаги воспроизведения:
1. Открыть страницу логина
2. Ввести корректные данные
3. Нажать "Войти"

Ожидаемый результат: Успешный вход в систему
Фактический результат: Ошибка 500

Приоритет: High
Компонент: Authentication
Тип: Bug
```

**Зачем это нужно?**
- ИИ будет использовать ваш шаблон как образец
- Новые задачи будут создаваться в том же стиле и структуре
- Соблюдение корпоративных стандартов оформления

## Использование

### В интерфейсе Jira

1. Откройте любую задачу Jira для редактирования
2. В поле описания появятся новые кнопки:
   - **"Улучшить"** — улучшает существующий текст
   - **"Шаблон"** — вставляет готовые шаблоны
   - **"История"** — показывает предыдущие версии

### Кнопка "Улучшить"

1. Напишите черновик описания задачи
2. Нажмите кнопку "Улучшить"
3. ИИ автоматически:
   - Структурирует текст
   - Добавит недостающие разделы
   - Использует ваш шаблон как образец (если настроен)
   - Улучшит формулировки

**Пример:**

*Было:*
```
логин не работает, ошибка какая-то
```

*Стало:*
```
Заголовок: Ошибка авторизации при входе в систему

Описание:
Пользователи не могут войти в систему из-за неизвестной ошибки.

Шаги воспроизведения:
1. Открыть страницу входа
2. Ввести учетные данные
3. Нажать кнопку "Войти"

Ожидаемый результат: Успешная авторизация
Фактический результат: Отображается ошибка

Приоритет: High
Тип: Bug
```

## Преимущества Few-Shot Prompting

### Без шаблона
ИИ создает задачи в общем стиле, может не соответствовать вашим стандартам.

### С шаблоном
- ✅ Соблюдение корпоративных стандартов
- ✅ Единообразное оформление всех задач
- ✅ Автоматическое добавление нужных полей
- ✅ Правильная структура и терминология
- ✅ Экономия времени на форматирование

## Поддерживаемые URL

Расширение работает на:
- `*.atlassian.net/*` (Atlassian Cloud)
- `*.jira.com/*` (стандартные домены)
- `jira*.company.domain/*` (корпоративные установки)
- `jira2*.company.domain/*` 
- `jira3*.company.domain/*`
- `localhost/*` (для разработки)

## Безопасность

- API ключи хранятся локально в браузере
- Данные не передаются третьим лицам
- Все запросы идут напрямую к выбранному LLM провайдеру
- Поддержка корпоративных прокси и VPN

## Устранение проблем

### Расширение не загружается
- Проверьте, что включен "Режим разработчика"
- Убедитесь, что выбрана папка `dist/`, а не корневая

### Кнопки не появляются в Jira
- Проверьте URL сайта в настройках расширения
- Обновите страницу Jira
- Убедитесь, что вы в режиме редактирования задачи

### ИИ не отвечает
- Проверьте API ключ в настройках
- Убедитесь в наличии интернет-соединения
- Проверьте лимиты API провайдера

### Ответы не соответствуют шаблону
- Убедитесь, что шаблон заполнен и сохранен
- Проверьте, что в шаблоне есть конкретные примеры структуры
- Попробуйте более детальный шаблон

## Примеры шаблонов

### Для багов
```
Заголовок: [Компонент] Краткое описание проблемы

Описание: Детальное описание проблемы

Шаги воспроизведения:
1. Шаг 1
2. Шаг 2
3. Шаг 3

Ожидаемый результат: Что должно происходить
Фактический результат: Что происходит на самом деле

Приоритет: High/Medium/Low
Компонент: Название компонента
Тип: Bug
```

### Для новых функций
```
Заголовок: [Функция] Название новой возможности

Описание: 
Как пользователь, я хочу [цель], чтобы [причина].

Критерии приемки:
- [ ] Критерий 1
- [ ] Критерий 2
- [ ] Критерий 3

Дополнительная информация:
- Макеты/скриншоты
- Технические требования
- Зависимости

Приоритет: High/Medium/Low
Тип: Story
```

### Для задач
```
Заголовок: [Область] Конкретная задача

Описание:
Необходимо выполнить [что именно] для [цели].

План выполнения:
1. Этап 1
2. Этап 2
3. Этап 3

Результат:
Описание ожидаемого результата

Приоритет: High/Medium/Low
Тип: Task
```

## Обновления

Расширение автоматически сохраняет настройки при обновлениях. При установке новой версии:
1. Ваши API ключи и настройки сохранятся
2. Шаблоны останутся без изменений
3. История использования будет доступна

---

**Поддержка:** Если у вас есть вопросы или предложения, создайте issue в репозитории проекта.

**Версия:** 2.2.2+
